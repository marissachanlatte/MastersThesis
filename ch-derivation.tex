\section{Derivation of One-Group NDA}
For reference, we repeat the derivation of the low-order NDA equation found in \cite{morel-holo} with small modifications assuming no fission source and vacuum boundary conditions. Consider the first order, one-group, fixed-source, steady-state \sn transport equation with isotropic scattering. 

  \begin{equation}
  \vec{\Omega}_{\mrm}\cdot \nabla \psi_{\mrm} \left(\vec{r}\right)+ \sigma_{\mm{t}}\left(\vec{r}\right)\psi_{\mrm} = \frac{1}{4 \pi} \sigma_{\mm{s}}\left(\vec{r}\right) \phi\left(\vec{r}\right) + \frac{1}{4 \pi} Q\:.
  \end{equation}
where $\phi = \sum\limits_{\mrm=1}^M \omega_\mrm \psi_{\mrm}$. Multiply the equation by angular weights and sum over all directions to obtain the zeroth moment equation
\begin{equation}
  \nabla J + \sigma_a\phi  =  Q
  \label{eq:zeroth_moment_1g}
  \end{equation}
where $J = \sum\limits_{\mrm=1}^{M}\omega_\mrm \vec{\Omega}\psi_\mrm$ and $\sigma_a$ is the absorption cross section.   Now consider the first moment equation:
  \begin{equation}
  \nabla P + \sigma_t J = 0
  \end{equation}
where $\nabla P =  \Omega_\mrm \Omega_\mrm \nabla \psi$. It can be rewritten as: 

  \begin{equation}
  J= -\frac{1}{\sigma_t} \nabla P. 
  \end{equation}
  By adding and subtracting the diffusion coefficient, $D = \frac{1}{3\sigma_t}$, times the gradient of the flux, it takes the form of a correction to Fick's Law. 
  \begin{equation}
  J = -D \nabla \phi + D \nabla \phi - \frac{1}{\sigma_t} \nabla P \\
  = -D \nabla \phi - \vec{\textbf{D}} \phi
  \label{eq:fick_corr_1g}
  \end{equation}
  where 
 \begin{equation}
  \vec{\textbf{D}} (\psi) = \frac{\sum\limits_{\mrm=1}^M \omega_\mrm [\frac{1}{\sigma_t} \vec{\Omega}_\mrm \vec{\Omega}_\mrm \cdot \nabla\psi^{ho}_\mrm - D \nabla \sum\limits_{\mrm=1}^M \omega_\mrm\psi^{ho}_\mrm]}{\sum\limits_{\mrm=1}^M \omega_\mrm \psi^{ho}_\mrm}.
  \end{equation} 
Where $\psi^{ho}$ indicates the solution of the higher order equation. Plugging \ref{eq:fick_corr_1g} into \ref{eq:zeroth_moment_1g} we have the following NDA equation:
  \begin{equation}
  \nabla\cdot(-D \nabla \phi - \vec{\bf D} \phi) + \sigma_a \phi = Q \:. \label{eq:NDA_1g}
  \end{equation}

\section{The Two-Grid Method}
The original two-grid (TG) method is described in detail in \cite{morel-upscat}. We will restate it here for reference. Consider the first order, fixed-source, multigroup, steady state, \sn\ transport equation with isotropic scattering and internal source, where $\rg$ is the group index and $m$ is the angle index:
  \begin{equation}
  \vec{\Omega}_{\mrm,\rg}\cdot \nabla \psi_{\mrm,\rg} \left(\vec{r}\right)+ \sigma_{\mm{t},\rg}\left(\vec{r}\right)\psi_{\mrm,\rg} = \frac{1}{4 \pi} \sum\limits_{\rg'=1}^\mm{G} \sigma_{\mm{s},\rgp\to\rg}\left(\vec{r}\right) \phi_{\rg'}\left(\vec{r}\right) + \frac{1}{4 \pi} Q_\rg\:.
  \label{eq:sn_mg}
  \end{equation}
  Where $\phi_\rg = \sum\limits_{\mrm=1}^M \omega_\mrm \psi_{\mrm, \rg}$. Here, we assume vacuum boundary conditions. In the case of upscattering, we employ the Gauss-Seidel (GS) method which splits up the scattering term and is given by 
  \begin{equation}
  \begin{split}
  \vec{\Omega}_{\mrm,\rg}\cdot \nabla \psi^{k+1}_{\mrm,\rg} \left(\vec{r}\right) + \sigma_{\mm{r},\rg}\psi^{k+1}_{\mrm,\rg} = &\frac{1}{4 \pi} \sum\limits_{\rg'=1}^\mm{\rg-1} \sigma_{\mm{s},\rgp\to\rg} \phi^{k+1}_{\rg'}\left(\vec{r}\right)  \\ +  &\frac{1}{4 \pi} \sum\limits_{\rg'=\rg+1}^\mm{G} \sigma_{\mm{s},\rgp\to\rg} \phi^{k}_{\rg'}\left(\vec{r}\right) + \frac{1}{4 \pi} Q_\rg\:,
  \end{split}
  \label{eq:GS}
  \end{equation}
  where $k$ is the GS iteration index. Subtracting equation \ref{eq:sn_mg} and \ref{eq:GS} gives
  \begin{equation}
    \begin{split}
      \vec{\Omega}_{\mrm,\rg} \cdot \nabla(\psi_{\mrm, \rg} - \psi^{k+1}_{\mrm, \rg}) + \sigma_{\mm{r}, \rg}(\psi_{\mrm, \rg} - \psi^{k+1}_{\mrm, \rg}) = &\frac{1}{4 \pi} \sum\limits_{\rg'= 1}^\mm{\rg-1} \sigma_{\mm{s},\rgp\to\rg} ( \phi _{\rg'} - \phi^{k+1}_{\rg'} ) \\  + &\frac{1}{4 \pi} \sum\limits_{\rg'=\rg+1}^\mm{G} \sigma_{\mm{s},\rgp\to\rg} (\phi_{\rg'} - \phi^{k}_{\rg'} ) 
    \end{split}
  \end{equation}
  We add and subtract $\frac{1}{4 \pi} \sum\limits_{\rg'=\rg+1}^\mm{G} \sigma_{\mm{s},\rgp\to\rg} \phi^{k+1}_{\rg'}$ to get 
    \begin{equation}
    \begin{split}
      \vec{\Omega}_{\mrm,\rg} \cdot \nabla\varepsilon^{k+1}_\rg + \sigma_{\mm{r}, \rg}\varepsilon^{k+1}_\rg = &\frac{1}{4 \pi} \sum\limits_{\rg'\neq \rg}^G \sigma_{\mm{s},\rgp\to\rg} \epsilon^{k+1}_\rg   + R_\rg^{k+1},
    \end{split}
    \label{eq:GS-error}
  \end{equation}
  where we define the following terms:
  \begin{align*}
      \varepsilon^{k+1}_\rg &:= \psi_{\mrm, \rg} - \psi^{k+1}_{\mrm, \rg} \\
      \epsilon^{k+1}_\rg &:= \phi_{\mrm, \rg} - \phi^{k+1}_{\mrm, \rg} \\
      R_\rg^{k+1} &:= \frac{1}{4 \pi} \sum\limits_{\rg'=\rg+1}^\mm{G} \sigma_{\mm{s},\rgp\to\rg} (\phi^{k+1}_{\rg'} - \phi^{k}_{\rg'}).
  \end{align*}
  Equation \ref{eq:GS-error} is an exact expression of of the error in the $k+1$ Gauss-Seidel iteration. To solve \ref{eq:sn_mg} exactly, we can solve \ref{eq:GS} to get the Gauss-Seidel iteration value and then correct by adding the solution of the error equation, \ref{eq:GS-error}. However, although that procedure would yield an exact result, it would be just as inefficient as solving \ref{eq:sn_mg} directly. To improve computational efficiency, we perform a similar procedure, but use an approximation for the error. In this case we will use an energy collapsed diffusion equation to generate the correction term. The standard multigroup diffusion equation for the error is
  
  \begin{equation}
      -\nabla D_\rg \nabla \epsilon_\rg^{k+1} + \sigma_{\mm{r}, \rg} \epsilon_\rg^{k+1} = \sum\limits_{\rg' \neq \rg}^G \sigma_{s, \rg' \rightarrow \rg}\epsilon_{\rg'}^{k+1} + R_\rg^{k+1}
  \end{equation}
  where $D = \frac{1}{3\sigma_t}$. To collapse this equation into one group, we split the error in to spatial and energy components:
  \begin{equation}
      \epsilon_g^{k+1} = \phi_\epsilon^{k+1}\xi_g, \hspace{5mm} \sum_{\rg=1}^G \xi = 1. 
  \end{equation}
  The energy-shape function $\xi_g$ is the eigenvfunction corresponding to the spectral radius of the theoretical Gauss-Seidel iteration matrix. Integrating over all groups gives 
  \begin{equation}
       -\nabla \cdot ( \left<D \right > \nabla \phi_\epsilon^{k+1} + \left< \textbf{D} \right> \phi_\epsilon^{k+1}) + \left < \sigma_{\mm{r}} \right> \phi_\epsilon^{k+1} = \left < R^{k+1} \right> , 
       \label{eq:diff-error}
  \end{equation}
 where
 \begin{align*}
     \left< D \right > &= \sum\limits_{\rg=1}^G D_\rg \xi_\rg \\
     \left< \textbf{D} \right > &= \sum\limits_{\rg=1}^G D_\rg \nabla \xi_\rg \\
     \left< \sigma_\mm{r} \right > &= \sum\limits_{\rg=1}^G \sigma_{\mm{r}, \rg} \xi_\rg \\
     \left< R^{k+1} \right > &= \sum\limits_{\rg=1}^G R_\rg^{k+1}.
 \end{align*}
 We solve via the same procedure as described above, with \ref{eq:diff-error} as the correction term. 
\section{Derivation of TG-NDA}
Consider the first order, fixed-source, multigroup, steady state, \sn\ transport equation with isotropic scattering and internal source, where $\rg$ is the group index and $m$ is the angle index:
  \begin{equation}
  \vec{\Omega}_{\mrm,\rg}\cdot \nabla \psi_{\mrm,\rg} \left(\vec{r}\right)+ \sigma_{\mm{t},\rg}\left(\vec{r}\right)\psi_{\mrm,\rg} = \frac{1}{4 \pi} \sum\limits_{\rg'=1}^\mm{G} \sigma_{\mm{s},\rgp\to\rg}\left(\vec{r}\right) \phi_{\rg'}\left(\vec{r}\right) + \frac{1}{4 \pi} Q_\rg\:.
  \end{equation}
  Where $\phi_\rg = \sum\limits_{\mrm=1}^M \omega_\mrm \psi_{\mrm, \rg}$. Here, we assume vacuum boundary conditions. Using a similar technique as Peterson et al.\ used for the one group case, we multiply by angular weights and sum to get the zeroth moment equation \cite{morel-holo}.

  \begin{equation}
  \nabla J + \sigma_{r,\rg}\phi_g  = \sum_{\substack{\rg'=1 \\ \rg' \neq \rg}}^G \sigma_{s,\rg' \rightarrow g}\phi_{\rg'} + Q_\rg
  \label{eq:zeroth_moment}
  \end{equation}
where $J = \sum\limits_{\mrm=1}^{M}\omega_\mrm \vec{\Omega}\psi_\mrm$ and the removal cross section, $\sigma_{r, \rg} = \sigma_{t, \rg} - \sigma_{s, \rg \rightarrow \rg}$ . 
  Now consider the first moment equation:
  \begin{equation}
  \nabla P + \sigma_t J = 0
  \end{equation}
where $\nabla P =  \Omega_{m,g} \Omega_{m,g} \nabla \psi_{g}$. It can be rewritten as: 

  \begin{equation}
  J= -\frac{1}{\sigma_t} \nabla P. 
  \end{equation}
  By adding and subtracting the diffusion coefficient, $D = \frac{1}{3\sigma_t}$, times the gradient of the flux, it takes the form of a correction to Fick's Law. 
  \begin{equation}
  J = -D \nabla \phi_g + D \nabla \phi_g - \frac{1}{\sigma_t} \nabla P \\
  = -D \nabla \phi_g - \vec{\textbf{D}} \phi_g
  \label{eq:fick_corr}
  \end{equation}
  where 
 \begin{equation}
  \vec{\textbf{D}} (\psi_\rg) = \frac{\sum\limits_{\mrm=1}^M \omega_\mrm [\frac{1}{\sigma_t} \vec{\Omega}_\mrm \vec{\Omega}_\mrm \cdot \nabla\phi_\mrm - D \nabla \sum\limits_{\mrm=1}^M \omega_\mrm\psi_\mrm]}{\sum\limits_{\mrm=1}^M \omega_\mrm \psi_\mrm}.
  \end{equation} 
 Plugging \ref{eq:fick_corr} into \ref{eq:zeroth_moment} we have the following NDA equation:
  \begin{equation}
  \nabla\cdot(-D_\rg \nabla \phi_\rg - \vec{\bf D}_\rg \phi_\rg) + \sigma_{r,\rg} \phi_\rg = \sum\limits_{\rgp\neq\rg}\sigma_{\mm{s},\rg' \rightarrow \rg}\phi_{\rg'} + Q_\rg \:. \label{eq:NDA}
  \end{equation}
  The two grid method for upscatter acceleration involves two calculations at each iteration. We will refer to these intermediate calculations as half iterations. To add in the upscatter acceleration we must determine an equation for the error correction. We start with the $k + 1/2$ iteration, expressed as:
  \begin{equation}
  \begin{split}
  \nabla\cdot(-D_\rg \nabla \phi_\rg^{k+1/2} - \vec{\bf D}_\rg \phi_\rg^{k+1/2}) &+ \sigma_{r,\rg} \phi_\rg^{k+1/2} =  \\ &\sum\limits_{\substack{\rg'=1}}^\mm{g-1} \sigma_{\mm{s},\rg' \to\rg}\phi_{\rg}^{k+1/2} + \sum\limits_{\substack{\rg'=\rg+1}}^\mm{G} \sigma_{\mm{s},\rg' \to\rg}\phi_{\rg'}^{k} + Q_\rg\:. 
  \end{split}
  \label{eq:k1/2}
  \end{equation}
  We next define the following terms:
  \begin{equation}
  \epsilon_\rg^{k+1/2} := \phi_\rg - \phi_\rg^{k + 1/2} \quad \mm{and} \quad R_\rg^{k+1/2} := \sum\limits_{\rg'=\rg+1}^\mm{G} \sigma_{\mm{s},\rg' \rg}\left(\phi_{\rg'}^k - \phi_{\rg'}^{k + 1/2}\right)\:.
  \end{equation}
  $\epsilon_\rg^{k + 1/2}$ can be further broken into the spatial component $\epsilon$ and scattering spectrum $\xi_\rg$ as defined in \cite{morel-upscat,evans-upscat}.
  \begin{equation}
  \epsilon_\rg^{k+1/2} = \phi_{\epsilon}^{k+1/2}\left(\vec{r}\right)\xi_\rg, \hspace{5mm} \sum\limits_{\rg=1}^G \xi_\rg = 1.
  \end{equation}
  Subtracting Eq.\ \eqref{eq:k1/2}\ from Eq.\ \eqref{eq:NDA}\ and adding and subtracting $R_\rg^{k+1/2}$\ gives an exact formulation of the error, but for the sake of efficiency, we approximate the error using the following diffusion approximation:
  \begin{equation}
  \nabla\cdot(-D_\rg  \nabla \epsilon_\rg^{k+1/2} - \vec{\bf D}_\rg
  \epsilon_\rg^{k+1/2}) + \sigma_{r,\rg}  \epsilon_\rg^{k+1/2} =  \sum\limits_{\substack{\rgp\neq\rg}} \sigma_{\mm{s},\rg' \to\rg}  \epsilon_{\rg'}^{k+1/2} -  R^{k+1/2}_\rg \:.
  \end{equation}
  We split the error into spatial and energy components and then integrate over all groups to collapse into a one group equation.
  \begin{equation}
  \nabla\cdot(-\left< D \xi \right> \nabla \phi_{\epsilon}^{k+1/2} - \left<\vec{\bf D} \xi
  \right> \phi_{\epsilon}^{k+1/2}) + \left< \sigma_{a} \right> \phi_{\epsilon}^{k+1/2} = - \left< R^{k+1/2} \right> \:,\label{eq:collapsed}
  \end{equation}
  where $\left< X \right> = \sum\limits_{\rg = 1}^G X_\rg $ and $\sigma_{a,\rg}  = \sigma_{r,\rg}\xi_\rg - \sum\limits_{\rgp\neq\rg} \sigma_{s,\rg'\rightarrow \rg} \xi_{\rg'}$.
  \par
  Using our approximation for the error, we can find the flux by solving Eqs.\ \eqref{eq:k1/2}\ and \eqref{eq:collapsed}\ to get $\phi_\rg^{k+1} = \phi_\rg^{k+1/2} + \epsilon_\rg^{k+1/2}$.