Consider the first order, fixed-source, multigroup, steady state, \sn\ transport equation with isotropic scattering and internal source, where $\rg$ is the group index and $m$ is the angle index:
  \begin{equation}
  \vec{\Omega}_{\mrm,\rg}\cdot \nabla \psi_{\mrm,\rg} \left(\vec{r}\right)+ \sigma_{\mm{t},\rg}\left(\vec{r}\right)\psi_{\mrm,\rg} = \frac{1}{4 \pi} \sum\limits_{\rg'=1}^\mm{G} \sigma_{\mm{s},\rgp\to\rg}\left(\vec{r}\right) \phi_{\rg'}\left(\vec{r}\right) + \frac{1}{4 \pi} Q_\rg\:.
  \end{equation}
  Where $\phi = \sum\limits_{\mrm=1}^M \omega_\mrm \psi_{\mrm, \rg}$. Here, we assume vacuum boundary conditions. Using a similar technique as Peterson et al.\ used for the one group case, we multiply by angular weights and sum to get the zeroth moment equation \cite{morel-holo}.

  \begin{equation}
  \nabla J + \sigma_{r,\rg}\phi_g  = \sum_{\substack{\rg'=1 \\ \rg' \neq \rg}}^G \sigma_{s,\rg' \rightarrow g}\phi_{\rg'} + Q_\rg
  \label{eq:zeroth_moment}
  \end{equation}
where $J = \sum\limits_{\mrm=1}^{M}\omega_\mrm \vec{\Omega}\psi_\mrm$ and the removal cross section, $\sigma_{r, \rg} = \sigma_{t, \rg} - \sigma_{s, \rg \rightarrow \rg}$ . 
  Now consider the first moment equation:
  \begin{equation}
  \nabla P + \sigma_t J = 0
  \end{equation}
where $\nabla P =  \Omega_{m,g} \Omega_{m,g} \nabla \psi_{g}$. It can be rewritten as: 

  \begin{equation}
  J= -\frac{1}{\sigma_t} \nabla P. 
  \end{equation}
  By adding and subtracting the diffusion coefficient, $D = \frac{1}{3\sigma_t}$, times the gradient of the flux, it takes the form of a correction to Fick's Law. 
  \begin{equation}
  J = -D \nabla \phi_g + D \nabla \phi_g - \frac{1}{\sigma_t} \nabla P \\
  = -D \nabla \phi_g - \vec{\textbf{D}} \phi_g
  \label{eq:fick_corr}
  \end{equation}
  where 
 \begin{equation}
  \vec{\textbf{D}} (\psi_\rg) = \frac{\sum\limits_{\mrm=1}^M \omega_\mrm [\frac{1}{\sigma_t} \vec{\Omega}_\mrm \vec{\Omega}_\mrm \cdot \nabla\phi_\mrm - D \nabla \sum\limits_{\mrm=1}^M \omega_\mrm\psi_\mrm]}{\sum\limits_{\mrm=1}^M \omega_\mrm \psi_\mrm}.
  \end{equation} 
 Plugging \ref{eq:fick_corr} into \ref{eq:zeroth_moment} we have the following NDA equation:
  \begin{equation}
  \nabla\cdot(-D_\rg \nabla \phi_\rg - \vec{\bf D}_\rg \phi_\rg) + \sigma_{r,\rg} \phi_\rg = \sum\limits_{\rgp\neq\rg}\sigma_{\mm{s},\rg' \rightarrow \rg}\phi_{\rg'} + Q_\rg \:. \label{eq:NDA}
  \end{equation}
  The two grid method for upscatter acceleration involves two calculations at each iteration. We will refer to these intermediate calculations as half iterations. To add in the upscatter acceleration we must determine an equation for the error correction. We start with the $k + 1/2$ iteration, expressed as:
  \begin{equation}
  \begin{split}
  \nabla\cdot(-D_\rg \nabla \phi_\rg^{k+1/2} - \vec{\bf D}_\rg \phi_\rg^{k+1/2}) &+ \sigma_{r,\rg} \phi_\rg^{k+1/2} =  \\ &\sum\limits_{\substack{\rg'=1}}^\mm{g-1} \sigma_{\mm{s},\rg' \to\rg}\phi_{\rg}^{k+1/2} + \sum\limits_{\substack{\rg'=\rg+1}}^\mm{G} \sigma_{\mm{s},\rg' \to\rg}\phi_{\rg'}^{k} + Q_\rg\:. 
  \end{split}
  \label{eq:k1/2}
  \end{equation}
  We next define the following terms:
  \begin{equation}
  \epsilon_\rg^{k+1/2} := \phi_\rg - \phi_\rg^{k + 1/2} \quad \mm{and} \quad R_\rg^{k+1/2} := \sum\limits_{\rg'=\rg+1}^\mm{G} \sigma_{\mm{s},\rg' \rg}\left(\phi_{\rg'}^k - \phi_{\rg'}^{k + 1/2}\right)\:.
  \end{equation}
  $\epsilon_\rg^{k + 1/2}$ can be further broken into the spatial component $\epsilon$ and scattering spectrum $\xi_\rg$ as defined in \cite{morel-upscat,evans-upscat}.
  \begin{equation}
  \epsilon_\rg^{k+1/2} = \phi_{\epsilon}^{k+1/2}\left(\vec{r}\right)\xi_\rg, \hspace{5mm} \sum\limits_{\rg=1}^G \xi_\rg = 1.
  \end{equation}
  Subtracting Eq.\ \eqref{eq:k1/2}\ from Eq.\ \eqref{eq:NDA}\ and adding and subtracting $R_\rg^{k+1/2}$\ gives an exact formulation of the error, but for the sake of efficiency, we approximate the error using the following diffusion approximation:
  \begin{equation}
  \nabla\cdot(-D_\rg  \nabla \epsilon_\rg^{k+1/2} - \vec{\bf D}_\rg
  \epsilon_\rg^{k+1/2}) + \sigma_{r,\rg}  \epsilon_\rg^{k+1/2} =  \sum\limits_{\substack{\rgp\neq\rg}} \sigma_{\mm{s},\rg' \to\rg}  \epsilon_{\rg'}^{k+1/2} -  R^{k+1/2}_\rg \:.
  \end{equation}
  We split the error into spatial and energy components and then integrate over all groups to collapse into a one group equation.
  \begin{equation}
  \nabla\cdot(-\left< D \xi \right> \nabla \phi_{\epsilon}^{k+1/2} - \left<\vec{\bf D} \xi
  \right> \phi_{\epsilon}^{k+1/2}) + \left< \sigma_{a} \right> \phi_{\epsilon}^{k+1/2} = - \left< R^{k+1/2} \right> \:,\label{eq:collapsed}
  \end{equation}
  where $\left< X \right> = \sum\limits_{\rg = 1}^G X_\rg $ and $\sigma_{a,\rg}  = \sigma_{r,\rg}\xi_\rg - \sum\limits_{\rgp\neq\rg} \sigma_{s,\rg'\rightarrow \rg} \xi_{\rg'}$.
  \par
  Using our approximation for the error, we can find the flux by solving Eqs.\ \eqref{eq:k1/2}\ and \eqref{eq:collapsed}\ to get $\phi_\rg^{k+1} = \phi_\rg^{k+1/2} + \epsilon_\rg^{k+1/2}$.